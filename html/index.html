<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Search Game</title>
</head>
<body>
    <h1>Welcome to the Word Search Game!</h1>
    <div id="message"></div>
    <div id="lobby">
        <h2>Lobby</h2>
        <p>Please enter your name:</p>
        <input type="text" id="nameInput">
        <button onclick="enterName()">Enter</button>
        <p>Options:</p>
        <button onclick="startGame()">Start Game</button>
        <button onclick="viewRules()">View Rules</button> <!-- Added View Rules button -->
    </div>
    <div id="rules" style="display: none;">
        <h2>Game Rules</h2>
        <p>Display game rules and instructions here.</p>
        <button onclick="backToLobby()">Back to Lobby</button>
    </div>
    <div id="game" style="display: none;">
        <h2>Game</h2>
        <p>List of available words:</p>
        <ul id="wordList"></ul>
        <p>Scoreboard:</p>
        <p id="scoreboard">Display current game score here.</p>
        <button onclick="chat()">Chat</button>
        <button onclick="displayGrid()">Display Game Grid</button>
        <button onclick="playerlist()">List of Players</button>
        <button onclick="gridinfo()">Game Grid Information</button>
        <button onclick="timer()">Start Timer</button>
        <div id="gridContainer"></div> <!-- Container for displaying the grid -->
    </div>

    <script>
        var nameInput = document.getElementById("nameInput");
        var messageDiv = document.getElementById("message");
        var lobbyDiv = document.getElementById("lobby");
        var rulesDiv = document.getElementById("rules");
        var gameDiv = document.getElementById("game");
        var wordListUl = document.getElementById("wordList");
        var scoreboardP = document.getElementById("scoreboard");
        var websocket;

        function enterName() {
            var playerName = nameInput.value.trim();
            if (playerName === "") {
                displayMessage("Please enter a valid name.");
            } else {
                displayMessage("Welcome, " + playerName + "!");
                lobbyDiv.style.display = "none";
                gameDiv.style.display = "block";

                // Establish WebSocket connection
                websocket = new WebSocket("ws://localhost:9880");
                websocket.onopen = function(event) {
                    console.log("WebSocket connection opened.");
                    // Send the player's name to the server
                    websocket.send(playerName);
                };
                websocket.onmessage = function(event) {
                    console.log("Message received from server:", event.data);
                    var msg = JSON.parse(event.data);
                    // Update word list and scoreboard based on the message received
                    updateWordList(msg.words);
                    updateScoreboard(msg.score);
                };
                websocket.onclose = function(event) {
                    console.log("WebSocket connection closed.");
                };
            }
        }

        function startGame() {
            displayMessage("Starting game...");
            // Implement starting game functionality
        }

        function viewRules() {
    var rulesList = [
        "1. Players take turns guessing a word.",
        "2. The word to be guessed must be a common English word with a words greater than 3 letter.",
        "3. After each guess, the host provides feedback indicating how many letters in the guess are correct and in the correct position.",
        "4. Players continue guessing until the word is correctly guessed or until the timer runs out.",
        "5. The player who correctly guesses the word wins the round."
    ];

    var rulesHTML = "<h2>Game Rules</h2><ul>";
    rulesList.forEach(function(rule) {
        rulesHTML += "<li>" + rule + "</li>";
    });
    rulesHTML += "</ul>";

    document.getElementById("rules").innerHTML = rulesHTML;
    document.getElementById("rules").style.display = "block";
    lobbyDiv.style.display = "none";
    gameDiv.style.display = "none";
}


        function backToLobby() {
            rulesDiv.style.display = "none";
            lobbyDiv.style.display = "block";
            gameDiv.style.display = "none";
        }

        function chat() {
            displayMessage("Chatting...");
            // Implement chat functionality
        }

        function displayGrid() {
            displayMessage("Displaying game grid...");
            // Call a function to generate and display the game grid
            generateAndDisplayGrid();
        }

        function playerlist() {
            displayMessage("List of players...");
            // Implement list of players in the game
        }

        function gridinfo() {
            displayMessage("Game grid information...");
            // Implement game grid information
        }

        function timer() {
            displayMessage("Starting timer...");
            // Implement timer functionality
        }

        function displayMessage(msg) {
            messageDiv.textContent = msg;
        }

        // Sample function to update the word list
        function updateWordList(words) {
            wordListUl.innerHTML = "";
            words.forEach(function(word) {
                var li = document.createElement("li");
                li.textContent = word;
                wordListUl.appendChild(li);
            });
        }

        // Sample function to update the scoreboard
        function updateScoreboard(score) {
            scoreboardP.textContent = "Score: " + score;
        }

        function displayGrid() {
            displayMessage("Displaying game grid...");

            // Make an AJAX request to fetch words from the server
            var xhr = new XMLHttpRequest();
            xhr.open("GET", "/fetchWords", true);
            xhr.onreadystatechange = function () {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    var letters = JSON.parse(xhr.responseText);
                    generateAndDisplayGrid(letters);
                }
            };
            xhr.send();
        }

        function generateAndDisplayGrid(letters) {
            var gridData = "<table>";
            for (var i = 0; i < 50; i++) {
                gridData += "<tr>";
                for (var j = 0; j < 50; j++) {
                    var index = i * 50 + j;
                    gridData += "<td>" + letters[index] + "</td>";
                }
                gridData += "</tr>";
            }
            gridData += "</table>";

            document.getElementById("gridContainer").innerHTML = gridData;
        }

        function displayMessage(msg) {
            document.getElementById("message").textContent = msg;
        }
    </script>
</body>
</html>
